"use strict";(self.webpackChunkwebsite_2=self.webpackChunkwebsite_2||[]).push([[976],{1140:(e,n,r)=>{r.d(n,{A:()=>s});const s=r.p+"assets/images/architecture-78841096403961eb53d19992f84cd2c0.jpg"},3415:(e,n,r)=>{r.r(n),r.d(n,{assets:()=>a,contentTitle:()=>t,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>o});const s=JSON.parse('{"id":"intro","title":"Skalds \u6846\u67b6\u4ecb\u7d39","description":"Skalds \u662f\u4e00\u5957\u4e8b\u4ef6\u9a45\u52d5\u7684\u6a21\u7d44\u5316\u5206\u6563\u5f0f\u4efb\u52d9\u8abf\u5ea6\u8207\u57f7\u884c\u7cfb\u7d71\uff0c\u9748\u611f\u4f86\u81ea\u5317\u6b50\u795e\u8a71\u4e2d\u7684\u541f\u904a\u8a69\u4eba\uff08Skalds\uff09\uff0c\u5c08\u70ba\u9ad8\u4f75\u767c\u3001\u53ef\u64f4\u5c55\u7684\u5f8c\u7aef\u4efb\u52d9\u7ba1\u7406\u800c\u8a2d\u8a08\u3002Skalds \u4ee5\u9b06\u8026\u5408\u67b6\u69cb\u3001\u5f48\u6027\u8cc7\u6e90\u8abf\u5ea6\u8207\u5b8c\u6574\u76e3\u63a7\u70ba\u6838\u5fc3\uff0c\u9069\u7528\u65bc AI \u904b\u7b97\u3001\u5f71\u50cf\u5206\u6790\u3001\u5373\u6642\u8cc7\u6599\u8655\u7406\u7b49\u591a\u7a2e\u5834\u666f\u3002","source":"@site/docs/intro.md","sourceDirName":".","slug":"/intro","permalink":"/Skalds/docs/intro","draft":false,"unlisted":false,"tags":[],"version":"current","frontMatter":{}}');var l=r(5813),d=r(9863);const i={},t="Skalds \u6846\u67b6\u4ecb\u7d39",a={},o=[{value:"\u8a2d\u8a08\u7406\u5ff5",id:"\u8a2d\u8a08\u7406\u5ff5",level:2},{value:"\u67b6\u69cb\u7e3d\u89bd",id:"\u67b6\u69cb\u7e3d\u89bd",level:2},{value:"\u6838\u5fc3\u7279\u6027",id:"\u6838\u5fc3\u7279\u6027",level:2},{value:"\u5178\u578b\u61c9\u7528\u5834\u666f",id:"\u5178\u578b\u61c9\u7528\u5834\u666f",level:2},{value:"\u5feb\u901f\u7bc4\u4f8b",id:"\u5feb\u901f\u7bc4\u4f8b",level:2},{value:"1. \u5b9a\u7fa9\u81ea\u8a02 Worker",id:"1-\u5b9a\u7fa9\u81ea\u8a02-worker",level:3},{value:"2. YAML \u914d\u7f6e\u591a\u500b Worker",id:"2-yaml-\u914d\u7f6e\u591a\u500b-worker",level:3},{value:"3. \u555f\u52d5 Skalds\uff08Edge/Node\uff09",id:"3-\u555f\u52d5-skaldsedgenode",level:3},{value:"\u9032\u4e00\u6b65\u95b1\u8b80",id:"\u9032\u4e00\u6b65\u95b1\u8b80",level:2}];function c(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",img:"img",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,d.R)(),...e.components};return(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(n.header,{children:(0,l.jsx)(n.h1,{id:"skalds-\u6846\u67b6\u4ecb\u7d39",children:"Skalds \u6846\u67b6\u4ecb\u7d39"})}),"\n",(0,l.jsxs)(n.p,{children:["Skalds \u662f\u4e00\u5957",(0,l.jsx)(n.strong,{children:"\u4e8b\u4ef6\u9a45\u52d5\u7684\u6a21\u7d44\u5316\u5206\u6563\u5f0f\u4efb\u52d9\u8abf\u5ea6\u8207\u57f7\u884c\u7cfb\u7d71"}),"\uff0c\u9748\u611f\u4f86\u81ea\u5317\u6b50\u795e\u8a71\u4e2d\u7684\u541f\u904a\u8a69\u4eba\uff08Skalds\uff09\uff0c\u5c08\u70ba\u9ad8\u4f75\u767c\u3001\u53ef\u64f4\u5c55\u7684\u5f8c\u7aef\u4efb\u52d9\u7ba1\u7406\u800c\u8a2d\u8a08\u3002Skalds \u4ee5\u9b06\u8026\u5408\u67b6\u69cb\u3001\u5f48\u6027\u8cc7\u6e90\u8abf\u5ea6\u8207\u5b8c\u6574\u76e3\u63a7\u70ba\u6838\u5fc3\uff0c\u9069\u7528\u65bc AI \u904b\u7b97\u3001\u5f71\u50cf\u5206\u6790\u3001\u5373\u6642\u8cc7\u6599\u8655\u7406\u7b49\u591a\u7a2e\u5834\u666f\u3002"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"\u8a2d\u8a08\u7406\u5ff5",children:"\u8a2d\u8a08\u7406\u5ff5"}),"\n",(0,l.jsx)(n.p,{children:"Skalds \u65e8\u5728\u89e3\u6c7a\u73fe\u4ee3\u5206\u6563\u5f0f\u4efb\u52d9\u7ba1\u7406\u7684\u4e09\u5927\u6311\u6230\uff1a"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u9ad8\u4f75\u767c\u8207\u9ad8\u6548\u80fd"}),"\uff1a\u652f\u63f4\u5927\u91cf\u4efb\u52d9\u4e26\u884c\u57f7\u884c\uff0c\u52d5\u614b\u8abf\u5ea6\u8cc7\u6e90\u3002"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u6a21\u7d44\u5316\u8207\u53ef\u64f4\u5c55"}),"\uff1a\u5404\u6a21\u7d44\u7368\u7acb\u3001\u53ef\u63d2\u62d4\uff0c\u6613\u65bc\u64f4\u5145\u8207\u7dad\u8b77\u3002"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u4e8b\u4ef6\u9a45\u52d5\u8207\u9b06\u8026\u5408"}),"\uff1a\u63a1\u7528 Pub/Sub \u6a5f\u5236\uff0c\u6a21\u7d44\u9593\u4e92\u52d5\u9748\u6d3b\uff0c\u964d\u4f4e\u8026\u5408\u5ea6\u3002"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"\u67b6\u69cb\u7e3d\u89bd",children:"\u67b6\u69cb\u7e3d\u89bd"}),"\n",(0,l.jsx)(n.p,{children:(0,l.jsx)(n.img,{alt:"Skalds Architecture",src:r(1140).A+"",width:"1257",height:"795"})}),"\n",(0,l.jsx)(n.p,{children:"Skalds \u7cfb\u7d71\u7531\u4e09\u5927\u6838\u5fc3\u6a21\u7d44\u8207\u591a\u500b\u652f\u63f4\u6a21\u7d44\u7d44\u6210\uff1a"}),"\n",(0,l.jsxs)(n.table,{children:[(0,l.jsx)(n.thead,{children:(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.th,{children:"\u6a21\u7d44"}),(0,l.jsx)(n.th,{children:"\u4e3b\u8981\u8077\u8cac"})]})}),(0,l.jsxs)(n.tbody,{children:[(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"System Controller"})}),(0,l.jsx)(n.td,{children:"\u7cfb\u7d71\u6838\u5fc3\u63a7\u5236\u5668\uff0c\u6574\u5408 API\u3001\u76e3\u63a7\u3001\u8abf\u5ea6\u3001\u5fc3\u8df3\u8207\u72c0\u614b\u7ba1\u7406"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"Monitor"})}),(0,l.jsx)(n.td,{children:"\u7cfb\u7d71\u6548\u80fd\u76e3\u63a7\u3001\u8cc7\u6e90\u5206\u6790\u3001\u4efb\u52d9\u72c0\u614b\u8ffd\u8e64\u3001\u8b66\u5831\u901a\u77e5"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"Dispatcher"})}),(0,l.jsx)(n.td,{children:"\u667a\u80fd\u4efb\u52d9\u5206\u914d\u3001\u52d5\u614b\u8ca0\u8f09\u5e73\u8861\u3001\u8cc7\u6e90\u512a\u5316"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"Task Generator (Skald)"})}),(0,l.jsx)(n.td,{children:"\u4efb\u52d9\u751f\u6210\u8207\u8abf\u5ea6\uff0c\u652f\u63f4 Edge/Node \u6a21\u5f0f\uff0c\u5f48\u6027\u914d\u7f6e\u8207\u81ea\u52d5\u8a3b\u518a"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"Task Worker"})}),(0,l.jsx)(n.td,{children:"\u5be6\u969b\u57f7\u884c\u4efb\u52d9\uff0c\u652f\u63f4\u591a\u968e\u6bb5\u3001\u91cd\u8a66\u3001\u52d5\u614b\u53c3\u6578\u66f4\u65b0"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"Event Queue"})}),(0,l.jsx)(n.td,{children:"\u57fa\u65bc Kafka \u7684\u4e8b\u4ef6\u4f47\u5217\uff0c\u5be6\u73fe\u9ad8\u6548 Pub/Sub \u901a\u8a0a"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"Cache Memory"})}),(0,l.jsx)(n.td,{children:"Redis \u5feb\u53d6\uff0c\u652f\u63f4\u9ad8\u983b\u8cc7\u6599\u8207\u7cbe\u7d30 TTL \u63a7\u5236"})]}),(0,l.jsxs)(n.tr,{children:[(0,l.jsx)(n.td,{children:(0,l.jsx)(n.strong,{children:"Disk Storage"})}),(0,l.jsx)(n.td,{children:"MongoDB \u6c38\u4e45\u5132\u5b58\uff0c\u652f\u63f4\u67e5\u8a62\u3001\u5206\u7247\u8207\u5bb9\u932f"})]})]})]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"\u6838\u5fc3\u7279\u6027",children:"\u6838\u5fc3\u7279\u6027"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u6a21\u7d44\u5316\u67b6\u69cb"}),"\uff1a\u4e09\u5927\u6838\u5fc3\u6a21\u7d44\uff08Skalds\u3001Monitor\u3001Dispatcher\uff09\u5206\u5de5\u660e\u78ba\uff0c\u6613\u65bc\u64f4\u5c55\u3002"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u4e8b\u4ef6\u9a45\u52d5\u901a\u8a0a"}),"\uff1a\u6240\u6709\u6a21\u7d44\u900f\u904e Kafka \u4e8b\u4ef6\u4f47\u5217\u9032\u884c\u9b06\u8026\u5408\u4e92\u52d5\u3002"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u667a\u80fd\u8cc7\u6e90\u8abf\u5ea6"}),"\uff1a\u6839\u64da\u5373\u6642\u8cc7\u6e90\u72c0\u614b\u81ea\u52d5\u5206\u914d\u4efb\u52d9\uff0c\u652f\u63f4\u5bb9\u5668\u5316\u81ea\u52d5\u64f4\u5bb9\u3002"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5b8c\u6574\u76e3\u63a7\u8207\u7ba1\u7406"}),"\uff1aMonitor \u6a21\u7d44\u63d0\u4f9b\u5168\u65b9\u4f4d\u76e3\u63a7\u8207\u4efb\u52d9\u751f\u547d\u9031\u671f\u7ba1\u7406\u3002"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5f48\u6027\u914d\u7f6e\u8207\u71b1\u66f4\u65b0"}),"\uff1a\u652f\u63f4 YAML \u914d\u7f6e\u3001\u53c3\u6578\u71b1\u91cd\u8f09\uff0c\u964d\u4f4e\u7dad\u904b\u6210\u672c\u3002"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u9ad8\u53ef\u7528\u8a2d\u8a08"}),"\uff1a\u591a\u526f\u672c\u3001\u5206\u7247\u3001\u6545\u969c\u81ea\u52d5\u6062\u5fa9\uff0c\u78ba\u4fdd\u7a69\u5b9a\u904b\u884c\u3002"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"\u5178\u578b\u61c9\u7528\u5834\u666f",children:"\u5178\u578b\u61c9\u7528\u5834\u666f"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"AI \u5f71\u50cf\u8fa8\u8b58\u8207\u9577\u6642\u9593\u904b\u7b97"}),"\uff1a\u5982\u8996\u8a0a\u6d41\u5206\u6790\u3001\u6df1\u5ea6\u5b78\u7fd2\u63a8\u8ad6\u7b49\u9700\u5927\u91cf\u8cc7\u6e90\u7684\u4efb\u52d9\u3002"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u9ad8\u4f75\u767c\u5f8c\u7aef\u670d\u52d9"}),"\uff1a\u52d5\u614b\u64f4\u5c55\u3001\u8ca0\u8f09\u6ce2\u52d5\u5927\u7684 Web \u670d\u52d9\u6216\u8cc7\u6599\u8655\u7406\u6d41\u6c34\u7dda\u3002"]}),"\n",(0,l.jsxs)(n.li,{children:[(0,l.jsx)(n.strong,{children:"\u5373\u6642\u4efb\u52d9\u7ba1\u7406"}),"\uff1a\u9700\u5373\u6642\u8abf\u5ea6\u3001\u66ab\u505c\u3001\u53d6\u6d88\u6216\u52d5\u614b\u66f4\u65b0\u7684\u696d\u52d9\u6d41\u7a0b\u3002"]}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"\u5feb\u901f\u7bc4\u4f8b",children:"\u5feb\u901f\u7bc4\u4f8b"}),"\n",(0,l.jsx)(n.h3,{id:"1-\u5b9a\u7fa9\u81ea\u8a02-worker",children:"1. \u5b9a\u7fa9\u81ea\u8a02 Worker"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:'from skalds.worker.baseclass import BaseTaskWorker, run_before_handler, run_main_handler, update_event_handler\nfrom pydantic import BaseModel, Field, ConfigDict\nimport time\n\nclass MyDataModel(BaseModel):\n    rtsp_url: str = Field(..., alias="rtspUrl")\n    fix_frame: int = Field(..., alias="fixFrame")\n    model_config = ConfigDict(populate_by_name=True, use_enum_values=True)\n\nclass MyWorker(BaseTaskWorker[MyDataModel]):\n    def initialize(self, data: MyDataModel) -> None:\n        self.rtsp_url = data.rtsp_url\n        self.fix_frame = data.fix_frame\n\n    @run_before_handler\n    def before_run(self) -> None:\n        print(f"Starting MyWorker with RTSP URL: {self.rtsp_url}")\n\n    @run_main_handler\n    def main_run(self) -> None:\n        for _ in range(10):\n            print(f"RTSP URL: {self.rtsp_url}, Fix Frame: {self.fix_frame}")\n            time.sleep(1)\n\n    @update_event_handler\n    def update_event(self, event_data: MyDataModel) -> None:\n        self.rtsp_url = event_data.rtsp_url\n        self.fix_frame = event_data.fix_frame\n'})}),"\n",(0,l.jsx)(n.h3,{id:"2-yaml-\u914d\u7f6e\u591a\u500b-worker",children:"2. YAML \u914d\u7f6e\u591a\u500b Worker"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-yaml",children:"TaskWorkers:\n  TaskWorker1:\n    isPersistent: true\n    attachments:\n      fix_frame: 10\n      rtsp_url: rtsp://192.168.1.1/camera1\n    className: MyWorker\n  TaskWorker2:\n    isPersistent: false\n    attachments:\n      enable_feature_x: true\n      job_id: job-12345\n      retries: 2\n      sub_tasks:\n        - name: Download Data\n          duration: 1.5\n          fail_chance: 0.2\n        - name: Process Data\n          duration: 2.0\n          fail_chance: 0.1\n    className: ComplexWorker\n"})}),"\n",(0,l.jsxs)(n.blockquote,{children:["\n",(0,l.jsxs)(n.p,{children:[(0,l.jsx)(n.code,{children:"isPersistent"})," \u65d7\u6a19\u50c5\u5728 ",(0,l.jsx)(n.code,{children:"single_process"})," \u6a21\u5f0f\u751f\u6548\uff0c\u5354\u52a9\u5340\u5206\u9577\u671f\u5e38\u99d0\u4efb\u52d9\uff08Deployment\uff09\u8207\u4e00\u6b21\u6027\u4efb\u52d9\uff08Job/CronJob\uff09\u3002"]}),"\n"]}),"\n",(0,l.jsx)(n.h3,{id:"3-\u555f\u52d5-skaldsedgenode",children:"3. \u555f\u52d5 Skalds\uff08Edge/Node\uff09"}),"\n",(0,l.jsx)(n.pre,{children:(0,l.jsx)(n.code,{className:"language-python",children:'from skalds import Skalds\nfrom skalds.config.skald_config import SkaldConfig\nfrom my_worker import MyWorker\nfrom complex_worker import ComplexWorker\n\nconfig = SkaldConfig(\n    skald_mode="edge",  # \u6216 "node"\n    yaml_file="all_workers.yml",\n    redis_host="localhost",\n    kafka_host="127.0.0.1",\n    mongo_host="mongodb://root:root@localhost:27017/"\n)\n\napp = Skalds(config)\napp.register_task_worker(MyWorker)\napp.register_task_worker(ComplexWorker)\napp.run()\n'})}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.h2,{id:"\u9032\u4e00\u6b65\u95b1\u8b80",children:"\u9032\u4e00\u6b65\u95b1\u8b80"}),"\n",(0,l.jsxs)(n.ul,{children:["\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"/Skalds/docs/quickstart",children:"\u5feb\u901f\u958b\u59cb"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"./documents",children:"\u7cfb\u7d71\u67b6\u69cb\u8207\u6a21\u7d44\u7d30\u7bc0"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"/Skalds/docs/documents/task_lifecycle",children:"\u4efb\u52d9\u751f\u547d\u9031\u671f\u8207\u4e8b\u4ef6\u6d41"})}),"\n",(0,l.jsx)(n.li,{children:(0,l.jsx)(n.a,{href:"/Skalds/docs/documents/yaml_config",children:"YAML \u914d\u7f6e\u7bc4\u4f8b"})}),"\n"]}),"\n",(0,l.jsx)(n.hr,{}),"\n",(0,l.jsx)(n.p,{children:"Skalds \u8b93\u4f60\u8f15\u9b06\u6253\u9020\u9ad8\u6548\u80fd\u3001\u53ef\u64f4\u5c55\u7684\u5206\u6563\u5f0f\u4efb\u52d9\u5e73\u53f0\uff0c\u7121\u8ad6\u662f AI \u904b\u7b97\u3001\u8cc7\u6599\u8655\u7406\u9084\u662f\u5373\u6642\u63a7\u5236\uff0c\u90fd\u80fd\u9748\u6d3b\u61c9\u5c0d\u3002"})]})}function h(e={}){const{wrapper:n}={...(0,d.R)(),...e.components};return n?(0,l.jsx)(n,{...e,children:(0,l.jsx)(c,{...e})}):c(e)}},9863:(e,n,r)=>{r.d(n,{R:()=>i,x:()=>t});var s=r(9729);const l={},d=s.createContext(l);function i(e){const n=s.useContext(d);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function t(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(l):e.components||l:i(e.components),s.createElement(d.Provider,{value:n},e.children)}}}]);